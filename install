#!/usr/bin/expect -f
# فایل: run_with_enter.expect
# اجرا: sudo apt install expect    # (اگر expect نصب نیست)
# سپس: chmod +x run_with_enter.expect && ./run_with_enter.expect

set timeout 30

# spawn با /bin/bash -c باعث میشه process substitution (<(...)) کار کنه
spawn /bin/bash -c {bash <(curl -Ls https://raw.githubusercontent.com/mhsanaei/3x-ui/master/install.sh)}

# منتظر یکی از پترن‌های معمولِ درخواست اینتر می‌شویم.
expect {
    -re "(Press Enter|Press any key|Any key to continue|Press any key to continue|برای ادامه Enter|Enter to continue)" {
        # وقتی دیدیم، یک بار اینتر می‌فرستیم
        send "\r"
        # بعد از فرستادن اینتر، اجازه میدیم کار ادامه پیدا کنه و به کاربر بازگردیم
    }
    timeout {
        # اگر پترن در زمان timeout پیدا نشد، باز یک بار اینتر می‌فرستیم (fallback)
        send "\r"
    }
    eof {
        # اسکریپت تمام شده؛ کاری لازم نیست
    }
}

# وصل شدن به ترمینال برای ادامه تعامل (اگر لازم باشه)
interact
